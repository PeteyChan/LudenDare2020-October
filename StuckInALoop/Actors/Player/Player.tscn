[gd_scene load_steps=4 format=2]

[ext_resource path="res://icon.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends RigidBody2D

export var runspeed = 100
var state = PlayerStates.idle
var state_time = 0
var velocity = Vector2.ZERO
onready var collider = $CollisionShape2D

# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

func _process(delta):
	process_statemachine(delta);
	pass
	
func _integrate_forces(state):
	state.linear_velocity = velocity
	var t = Transform2D(0, state.transform.origin)
	state.transform = t
	
func change(new_state):
	state = new_state
	state_time = 0
	print(\"player state : \", new_state)

func player_move_input():
	var x = Input.get_action_strength(\"player_move_right\") - Input.get_action_strength(\"player_move_left\")
	var y = -Input.get_action_strength(\"player_move_up\") + Input.get_action_strength(\"player_move_down\")
	return Vector2(x, y)

func process_statemachine(delta):
	state_time += delta
	match (state):
		PlayerStates.idle_enter:
			change(PlayerStates.idle)
			
		PlayerStates.idle:
			velocity = Vector2.ZERO
			if (player_move_input().length() > .1):
				change(PlayerStates.run)
			
		PlayerStates.run:
			if (player_move_input().length() < .1):
				change(PlayerStates.idle_enter)
			velocity = player_move_input() * runspeed
"

[sub_resource type="CircleShape2D" id=2]
radius = 33.9532

[node name="Player" type="RigidBody2D"]
position = Vector2( 488.212, 292.215 )
gravity_scale = 0.0
can_sleep = false
script = SubResource( 1 )

[node name="icon" type="Sprite" parent="."]
position = Vector2( 0, -30.9543 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( 0, -29.481 )
shape = SubResource( 2 )

[node name="Camera2D" type="Camera2D" parent="."]
current = true
